# Docker ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–‡ä»¶æ€»ç»“

## ğŸ“‹ å·²åˆ›å»ºçš„æ–‡ä»¶æ¸…å•

### ğŸ³ Docker é…ç½®æ–‡ä»¶
- `Dockerfile` - ç”Ÿäº§çº§åç«¯åº”ç”¨é•œåƒé…ç½®
- `docker-compose.prod.yml` - ç”Ÿäº§ç¯å¢ƒå¤šæœåŠ¡ç¼–æ’é…ç½®
- `.dockerignore` - Docker æ„å»ºå¿½ç•¥æ–‡ä»¶

### ğŸ”§ é…ç½®æ–‡ä»¶
- `docker/env.example.prod` - ç”Ÿäº§ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
- `database/mysql.cnf` - MySQL æ€§èƒ½ä¼˜åŒ–é…ç½®
- `database/redis.conf` - Redis æ€§èƒ½ä¼˜åŒ–é…ç½®
- `nginx/nginx.conf` - Nginx åå‘ä»£ç†é…ç½®

### ğŸš€ éƒ¨ç½²è„šæœ¬
- `deploy.sh` - å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è„šæœ¬ï¼ˆä¸»è„šæœ¬ï¼‰
- `scripts/production-start.sh` - å¿«é€Ÿå¯åŠ¨è„šæœ¬
- `scripts/monitor.sh` - ç³»ç»Ÿç›‘æ§è„šæœ¬

### ğŸ“š æ–‡æ¡£
- `PRODUCTION_DEPLOYMENT.md` - è¯¦ç»†çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—
- `DOCKER_DEPLOYMENT_SUMMARY.md` - æœ¬æ€»ç»“æ–‡æ¡£

## ğŸ—ï¸ æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Compose                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Nginx    â”‚  â”‚   Backend   â”‚  â”‚    MySQL    â”‚    â”‚
â”‚  â”‚   (80/443)  â”‚  â”‚   (8000)    â”‚  â”‚   (3307)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚    Redis    â”‚                                       â”‚
â”‚  â”‚   (6379)    â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

### æ–¹å¼1ï¼šä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬
```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp docker/env.example.prod .env.prod
nano .env.prod  # ä¿®æ”¹å¯†ç å’ŒAPIå¯†é’¥

# 2. å¿«é€Ÿå¯åŠ¨
./scripts/production-start.sh
```

### æ–¹å¼2ï¼šä½¿ç”¨å®Œæ•´éƒ¨ç½²è„šæœ¬
```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp docker/env.example.prod .env.prod
nano .env.prod  # ä¿®æ”¹å¯†ç å’ŒAPIå¯†é’¥

# 2. å®Œæ•´éƒ¨ç½²
./deploy.sh deploy

# 3. å¦‚éœ€å¯ç”¨ Nginx
./deploy.sh deploy --with-nginx
```

## ğŸ“Š ç›‘æ§å’Œç®¡ç†

### ç›‘æ§å‘½ä»¤
```bash
# ä¸€æ¬¡æ€§æ£€æŸ¥
./scripts/monitor.sh check

# æŒç»­ç›‘æ§
./scripts/monitor.sh watch

# ç”ŸæˆæŠ¥å‘Š
./scripts/monitor.sh report

# æŸ¥çœ‹ç›‘æ§æ—¥å¿—
./scripts/monitor.sh logs
```

### ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹çŠ¶æ€
./deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs

# é‡å¯æœåŠ¡
./deploy.sh restart

# å¤‡ä»½æ•°æ®
./deploy.sh backup

# åœæ­¢æœåŠ¡
./deploy.sh stop

# æ¸…ç†èµ„æº
./deploy.sh cleanup
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

### å¿…é¡»ä¿®æ”¹çš„é…ç½®
åœ¨ `.env.prod` æ–‡ä»¶ä¸­ï¼Œä»¥ä¸‹é…ç½®**å¿…é¡»**ä¿®æ”¹ï¼š

```env
# ğŸ”´ å¿…é¡»ä¿®æ”¹
SECRET_KEY=your-super-secret-key-change-this-in-production-256-bits-long
MYSQL_ROOT_PASSWORD=very-strong-root-password-123
MYSQL_PASSWORD=very-strong-user-password-456
OPENAI_API_KEY=your-openai-api-key
TAVILY_API_KEY=your-tavily-api-key
```

### é˜²ç«å¢™é…ç½®
```bash
sudo ufw allow 22      # SSH
sudo ufw allow 80      # HTTP
sudo ufw allow 443     # HTTPS
sudo ufw enable
```

## ğŸ“± æœåŠ¡è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåçš„è®¿é—®åœ°å€ï¼š

- **åç«¯ API**: `http://your-server:8000`
- **API æ–‡æ¡£**: `http://your-server:8000/docs`
- **å¥åº·æ£€æŸ¥**: `http://your-server:8000/health`
- **æ•°æ®åº“**: `your-server:3307`
- **Redis**: `your-server:6379`

## ğŸ”„ æ›´æ–°æµç¨‹

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. é‡æ–°æ„å»º
./deploy.sh build

# 3. é‡å¯æœåŠ¡
./deploy.sh restart
```

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è§£å†³
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs backend

# æ£€æŸ¥ç½‘ç»œ
docker network ls

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.prod.yml restart backend
```

## ğŸ“‹ éƒ¨ç½²æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•
- [ ] æœåŠ¡å™¨èµ„æºå……è¶³ï¼ˆRAM â‰¥ 2GB, ç£ç›˜ â‰¥ 10GBï¼‰
- [ ] Docker å’Œ Docker Compose å·²å®‰è£…
- [ ] å·²å¤åˆ¶å¹¶é…ç½® `.env.prod` æ–‡ä»¶
- [ ] å·²ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
- [ ] å·²é…ç½® API å¯†é’¥
- [ ] é˜²ç«å¢™å·²æ­£ç¡®é…ç½®

### éƒ¨ç½²åéªŒè¯æ¸…å•
- [ ] æ‰€æœ‰å®¹å™¨æ­£å¸¸è¿è¡Œ
- [ ] åç«¯å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] Redis è¿æ¥æ­£å¸¸
- [ ] API æ–‡æ¡£å¯è®¿é—®
- [ ] æ—¥å¿—æ— é”™è¯¯

---

**ğŸ‰ æ­å–œï¼æ‚¨å·²æˆåŠŸå®Œæˆç§äººé‡‘èåˆ†æå¸ˆåç«¯çš„ç”Ÿäº§ç¯å¢ƒDockeréƒ¨ç½²é…ç½®ï¼**

å¦‚éœ€æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ `PRODUCTION_DEPLOYMENT.md` æ–‡æ¡£ã€‚ 